{"ast":null,"code":"import _regeneratorRuntime from\"/media/mamun/Tools/MERN/prime-bd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/media/mamun/Tools/MERN/prime-bd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/media/mamun/Tools/MERN/prime-bd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import'../../../styles/user/upload-video/style.scss';import Icon from'react-icons-kit';import{useForm}from\"react-hook-form\";import{ic_cloud_upload}from'react-icons-kit/md';import axios from'axios';import url from'../../../utils/url';import{toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import Navbar from'../../../components/UserNavbar/Index';toast.configure();var Audio=function Audio(){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),categories=_useState4[0],setCategories=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),selectedAudio=_useState6[0],setSelectedAudio=_useState6[1];var _useState7=useState({audio:null}),_useState8=_slicedToArray(_useState7,2),fileErr=_useState8[0],setFileErr=_useState8[1];var header={headers:{Authorization:\"Bearer \"+localStorage.getItem(\"token\")}};useEffect(function(){// Fetch Categories\nvar fetchCategories=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"\".concat(url,\"user/categories\"),header);case 3:response=_context.sent;setCategories(response.data);setLoading(false);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);if(_context.t0){console.log(_context.t0.response);setLoading(false);}case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function fetchCategories(){return _ref.apply(this,arguments);};}();fetchCategories();},[]);// Audio onChange\nvar audioChangeHandeller=function audioChangeHandeller(event){var file=event.target.files[0];if(file&&file.size>7000000){setSelectedAudio(null);setFileErr({audio:'Select less than 7 MB file'});}else{setSelectedAudio(file);}};var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var formData,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;if(selectedAudio){_context2.next=3;break;}return _context2.abrupt(\"return\",setFileErr({audio:'Audio is required'}));case 3:setLoading(true);formData=new FormData();formData.append('user_id',localStorage.getItem('id'));formData.append('title',data.title);formData.append('category_id',data.category);formData.append('audio',selectedAudio);_context2.next=11;return axios.post(\"\".concat(url,\"user/audio/store\"),formData,header);case 11:response=_context2.sent;if(response.status===200){setLoading(false);toast.success(response.data.message);}_context2.next=18;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](0);if(_context2.t0){console.log(_context2.t0.response);}case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[0,15]]);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"upload\"},/*#__PURE__*/React.createElement(Navbar,{back:true,title:'Upload Audio'}),/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid py-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 px-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card border-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header p-3 text-center bg-white\"},/*#__PURE__*/React.createElement(Icon,{icon:ic_cloud_upload,size:40,style:{color:'#F4A261'}}),/*#__PURE__*/React.createElement(\"h6\",{className:\"mb-0\"},\"Upload Audio\")),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body py-4 px-0\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group mb-3\"},errors.title&&errors.title.message?/*#__PURE__*/React.createElement(\"small\",{className:\"text-danger\"},errors.title&&errors.title.message):/*#__PURE__*/React.createElement(\"small\",null,\"Audio title\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"title\",className:\"form-control shadow-none rounded-0\",placeholder:\"Enter audio title\",ref:register({required:\"Title is required\"})})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group mb-3\"},errors.category&&errors.category.message?/*#__PURE__*/React.createElement(\"small\",{className:\"text-danger\"},errors.category&&errors.category.message):/*#__PURE__*/React.createElement(\"small\",null,\"Select category\"),/*#__PURE__*/React.createElement(\"select\",{name:\"category\",className:\"form-control shadow-none rounded-0 pl-2\",ref:register({required:\"Category is required\"})},categories&&categories.map(function(category,i){return/*#__PURE__*/React.createElement(\"option\",{value:category.id,key:i},category.name);}))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group mb-3\"},fileErr&&fileErr.audio?/*#__PURE__*/React.createElement(\"small\",{className:\"text-danger\"},fileErr.audio):null,/*#__PURE__*/React.createElement(\"input\",{type:\"file\",id:\"audio\",className:\"inputfile\",accept:\"audio/*\",onChange:audioChangeHandeller}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"audio\"},/*#__PURE__*/React.createElement(\"p\",null,\"Audio file\"))),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary rounded-0 shadow-none text-white btn-block\"},\"Upload\"))))))),isLoading?/*#__PURE__*/React.createElement(\"div\",{className:\"upload-progress\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-center flex-column\"},/*#__PURE__*/React.createElement(\"h6\",null,\"Uploading...\"),/*#__PURE__*/React.createElement(\"p\",null,\"Don't leave before complete.\"))):null);};export default Audio;","map":{"version":3,"sources":["/media/mamun/Tools/MERN/prime-bd/client/src/pages/user/upload/Audio.js"],"names":["React","useEffect","useState","Icon","useForm","ic_cloud_upload","axios","url","toast","Navbar","configure","Audio","register","handleSubmit","errors","isLoading","setLoading","categories","setCategories","selectedAudio","setSelectedAudio","audio","fileErr","setFileErr","header","headers","Authorization","localStorage","getItem","fetchCategories","get","response","data","console","log","audioChangeHandeller","event","file","target","files","size","onSubmit","formData","FormData","append","title","category","post","status","success","message","color","required","map","i","id","name"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport '../../../styles/user/upload-video/style.scss'\nimport Icon from 'react-icons-kit'\nimport { useForm } from \"react-hook-form\"\nimport { ic_cloud_upload } from 'react-icons-kit/md'\nimport axios from 'axios'\nimport url from '../../../utils/url'\nimport { toast } from 'react-toastify'\nimport 'react-toastify/dist/ReactToastify.css'\n\nimport Navbar from '../../../components/UserNavbar/Index'\n\ntoast.configure()\nconst Audio = () => {\n    const { register, handleSubmit, errors } = useForm()\n    const [isLoading, setLoading] = useState(false)\n    const [categories, setCategories] = useState([])\n    const [selectedAudio, setSelectedAudio] = useState(null)\n    const [fileErr, setFileErr] = useState({ audio: null })\n\n    const header = {\n        headers:\n        {\n            Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n        }\n    }\n\n    useEffect(() => {\n        // Fetch Categories\n        const fetchCategories = async () => {\n            try {\n                const response = await axios.get(`${url}user/categories`, header)\n                setCategories(response.data)\n                setLoading(false)\n            } catch (error) {\n                if (error) {\n                    console.log(error.response)\n                    setLoading(false)\n                }\n            }\n        }\n\n        fetchCategories()\n    }, [])\n\n    // Audio onChange\n    const audioChangeHandeller = event => {\n        let file = event.target.files[0]\n        if (file && file.size > 7000000) {\n            setSelectedAudio(null)\n            setFileErr({ audio: 'Select less than 7 MB file' })\n        } else {\n            setSelectedAudio(file)\n        }\n    }\n\n    const onSubmit = async (data) => {\n        try {\n            if (!selectedAudio) {\n                return setFileErr({ audio: 'Audio is required' })\n            }\n\n            setLoading(true)\n            let formData = new FormData()\n            formData.append('user_id', localStorage.getItem('id'))\n            formData.append('title', data.title)\n            formData.append('category_id', data.category)\n            formData.append('audio', selectedAudio)\n\n            const response = await axios.post(`${url}user/audio/store`, formData, header)\n            if (response.status === 200) {\n                setLoading(false)\n                toast.success(response.data.message)\n            }\n        } catch (error) {\n            if (error) {\n                console.log(error.response)\n            }\n        }\n    }\n\n    return (\n        <div className=\"upload\">\n            <Navbar back={true} title={'Upload Audio'} />\n            <div className=\"container-fluid py-3\">\n                <div className=\"row\">\n                    <div className=\"col-12 px-5\">\n                        <div className=\"card border-0\">\n                            <div className=\"card-header p-3 text-center bg-white\">\n                                <Icon icon={ic_cloud_upload} size={40} style={{ color: '#F4A261' }} />\n                                <h6 className=\"mb-0\">Upload Audio</h6>\n                            </div>\n                            <div className=\"card-body py-4 px-0\">\n                                <form onSubmit={handleSubmit(onSubmit)}>\n                                    {/* Title */}\n                                    <div className=\"form-group mb-3\">\n                                        {errors.title && errors.title.message ? (\n                                            <small className=\"text-danger\">{errors.title && errors.title.message}</small>\n                                        ) : <small>Audio title</small>\n                                        }\n\n                                        <input\n                                            type=\"text\"\n                                            name=\"title\"\n                                            className=\"form-control shadow-none rounded-0\"\n                                            placeholder=\"Enter audio title\"\n                                            ref={register({\n                                                required: \"Title is required\",\n                                            })}\n                                        />\n                                    </div>\n\n                                    {/* Category */}\n                                    <div className=\"form-group mb-3\">\n                                        {errors.category && errors.category.message ? (\n                                            <small className=\"text-danger\">{errors.category && errors.category.message}</small>\n                                        ) : <small>Select category</small>\n                                        }\n\n                                        <select\n                                            name=\"category\"\n                                            className=\"form-control shadow-none rounded-0 pl-2\"\n                                            ref={register({\n                                                required: \"Category is required\",\n                                            })}\n                                        >\n                                            {categories && categories.map((category, i) =>\n                                                <option value={category.id} key={i}>{category.name}</option>\n                                            )}\n                                        </select>\n                                    </div>\n\n                                    {/* Audio */}\n                                    <div className=\"form-group mb-3\">\n                                        {fileErr && fileErr.audio ? (\n                                            <small className=\"text-danger\">{fileErr.audio}</small>\n                                        ) : null}\n                                        <input\n                                            type=\"file\"\n                                            id=\"audio\"\n                                            className=\"inputfile\"\n                                            accept=\"audio/*\"\n                                            onChange={audioChangeHandeller}\n                                        />\n                                        <label htmlFor=\"audio\">\n                                            <p>Audio file</p>\n                                        </label>\n                                    </div>\n\n                                    <button type=\"submit\" className=\"btn btn-primary rounded-0 shadow-none text-white btn-block\">Upload</button>\n\n\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Uploading Progress */}\n            {isLoading ?\n                <div className=\"upload-progress\">\n                    <div className=\"flex-center flex-column\">\n                        <h6>Uploading...</h6>\n                        <p>Don't leave before complete.</p>\n                    </div>\n                </div>\n                : null}\n        </div>\n    );\n};\n\nexport default Audio;"]},"metadata":{},"sourceType":"module"}