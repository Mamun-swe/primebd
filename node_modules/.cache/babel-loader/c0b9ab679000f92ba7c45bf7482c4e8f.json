{"ast":null,"code":"import _regeneratorRuntime from\"/media/mamun/Tools/MERN/prime-bd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/media/mamun/Tools/MERN/prime-bd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/media/mamun/Tools/MERN/prime-bd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/media/mamun/Tools/MERN/prime-bd/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import'../../../styles/user/chat/style.scss';import{useParams}from'react-router-dom';import Icon from'react-icons-kit';import{ic_near_me}from'react-icons-kit/md';import{useForm}from'react-hook-form';import io from'socket.io-client';import Navbar from'../../../components/UserNavbar/Index';import LoadingComponent from'../../../components/Loading/Index';import FourOFourComponent from'../../../components/FourOFour/Index';// import ScrollToBottom from 'react-scroll-to-bottom'\nvar socket;var MessageRoom=function MessageRoom(){var _useParams=useParams(),id=_useParams.id,name=_useParams.name;var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];var myId=localStorage.getItem('id');// const ENDPOINT = 'localhost:4000'\nvar ENDPOINT='https://chat-microservices.herokuapp.com';useEffect(function(){socket=io(ENDPOINT,{transports:['websocket','polling','flashsocket']});socket.emit(\"join\",myId);socket.on(\"message\",function(message){setMessages(function(exMessage){return[].concat(_toConsumableArray(exMessage),[message]);});setLoading(false);});},[id,name,myId,ENDPOINT]);// Submit Message\nvar onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data,event){var messageData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:messageData={sender:myId,reciver:id,message:data.message};setMessages(function(exMessage){return[].concat(_toConsumableArray(exMessage),[messageData]);});socket.emit('message',messageData,function(response){if(response){console.log('Successfully message send');}});event.target.reset();case 4:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x,_x2){return _ref.apply(this,arguments);};}();useEffect(function(){var data={sender:myId,reciver:id};socket.emit('getmessage',data,function(response){setMessages(response);setLoading(false);});},[]);return/*#__PURE__*/React.createElement(\"div\",{className:\"message-room\"},isLoading?/*#__PURE__*/React.createElement(LoadingComponent,null):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Navbar,{title:name,back:true}),/*#__PURE__*/React.createElement(\"div\",{className:\"conversation-container\"},messages&&messages.length>0?messages.map(function(items,i){return/*#__PURE__*/React.createElement(\"div\",{className:\"message\",key:i,id:\"message\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},items.reciver==myId?/*#__PURE__*/React.createElement(\"div\",{className:\"person-name-circle rounded-circle mr-1\"}):null,/*#__PURE__*/React.createElement(\"div\",{className:items.sender==myId?\"recived-message ml-auto text-right\":\"sender-message text-left\"},/*#__PURE__*/React.createElement(\"p\",null,items.message)),items.sender==myId?/*#__PURE__*/React.createElement(\"div\",{className:\"person-name-circle rounded-circle ml-1 bg-primary\"}):null));}):/*#__PURE__*/React.createElement(FourOFourComponent,{messages:'No message found.'})),/*#__PURE__*/React.createElement(\"div\",{className:\"message-sent-container shadow\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-fill\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"message\",className:errors.message?\"form-control shadow-none error-border\":\"form-control shadow-none border-0\",placeholder:\"Write message...\",ref:register({required:true})})),/*#__PURE__*/React.createElement(\"div\",{className:\"ml-1\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn rounded-circle shadow-none\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-center flex-column\"},/*#__PURE__*/React.createElement(Icon,{icon:ic_near_me,size:24,style:{color:'#007cfa'}})))))))));};export default MessageRoom;","map":{"version":3,"sources":["/media/mamun/Tools/MERN/prime-bd/client/src/pages/user/chat/MessageRoom.js"],"names":["React","useEffect","useState","useParams","Icon","ic_near_me","useForm","io","Navbar","LoadingComponent","FourOFourComponent","socket","MessageRoom","id","name","register","handleSubmit","errors","isLoading","setLoading","messages","setMessages","myId","localStorage","getItem","ENDPOINT","transports","emit","on","message","exMessage","onSubmit","data","event","messageData","sender","reciver","response","console","log","target","reset","length","map","items","i","required","color"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport '../../../styles/user/chat/style.scss'\nimport { useParams } from 'react-router-dom'\nimport Icon from 'react-icons-kit'\nimport { ic_near_me } from 'react-icons-kit/md'\nimport { useForm } from 'react-hook-form'\nimport io from 'socket.io-client'\n\nimport Navbar from '../../../components/UserNavbar/Index'\nimport LoadingComponent from '../../../components/Loading/Index'\nimport FourOFourComponent from '../../../components/FourOFour/Index'\n// import ScrollToBottom from 'react-scroll-to-bottom'\n\nlet socket;\n\nconst MessageRoom = () => {\n    const { id, name } = useParams()\n    const { register, handleSubmit, errors } = useForm()\n    const [isLoading, setLoading] = useState(true)\n    const [messages, setMessages] = useState([])\n    const myId = localStorage.getItem('id')\n    // const ENDPOINT = 'localhost:4000'\n    const ENDPOINT = 'https://chat-microservices.herokuapp.com'\n\n    useEffect(() => {\n        socket = io(ENDPOINT, { transports: ['websocket', 'polling', 'flashsocket'] })\n        socket.emit(\"join\", myId)\n        socket.on(\"message\", (message) => {\n            setMessages((exMessage) => [...exMessage, message])\n            setLoading(false)\n        })\n    }, [id, name, myId, ENDPOINT])\n\n    // Submit Message\n    const onSubmit = async (data, event) => {\n        const messageData = {\n            sender: myId,\n            reciver: id,\n            message: data.message\n        }\n        setMessages((exMessage) => [...exMessage, messageData])\n\n        socket.emit('message', messageData, (response) => {\n            if (response) {\n                console.log('Successfully message send');\n            }\n        })\n        event.target.reset()\n    }\n\n\n    useEffect(() => {\n        const data = {\n            sender: myId,\n            reciver: id\n        }\n        socket.emit('getmessage', data, (response) => {\n            setMessages(response)\n            setLoading(false)\n        })\n    }, []);\n\n\n\n    return (\n        <div className=\"message-room\">\n            {isLoading ? <LoadingComponent /> :\n                <div>\n                    <Navbar title={name} back={true} />\n\n                    {/* Conversation Container */}\n                    <div className=\"conversation-container\">\n\n                        {messages && messages.length > 0 ?\n                            messages.map((items, i) =>\n\n                                <div className=\"message\" key={i} id=\"message\">\n                                    <div className=\"d-flex\">\n                                        {/* Reciver */}\n                                        {items.reciver == myId ?\n                                            <div className=\"person-name-circle rounded-circle mr-1\">\n                                                {/* <div className=\"flex-center flex-column\">\n                                                    <h6>{sliceName(items.message)}</h6>\n                                                    <h6>{items.reciver}</h6>\n                                                </div> */}\n                                            </div>\n                                            : null}\n\n                                        {/* Conversation */}\n                                        <div className={items.sender == myId ? \"recived-message ml-auto text-right\" : \"sender-message text-left\"}>\n                                            <p>{items.message}</p>\n                                        </div>\n\n                                        {/* Sender */}\n                                        {items.sender == myId ?\n                                            <div className=\"person-name-circle rounded-circle ml-1 bg-primary\">\n                                                {/* <div className=\"flex-center flex-column\">\n                                                    <h6 className=\"text-white\">{sliceName(items.message)}</h6>\n                                                    <h6 className=\"text-white\">{items.sender}</h6>\n                                                </div> */}\n                                            </div>\n                                            : null}\n                                    </div>\n                                </div>\n\n                            )\n                            : <FourOFourComponent messages={'No message found.'} />}\n\n                    </div>\n\n\n                    {/* Message Sent Container */}\n                    <div className=\"message-sent-container shadow\">\n                        <form onSubmit={handleSubmit(onSubmit)}>\n                            <div className=\"d-flex\">\n                                <div className=\"flex-fill\">\n                                    <input\n                                        type=\"text\"\n                                        name=\"message\"\n                                        className={errors.message ? \"form-control shadow-none error-border\" : \"form-control shadow-none border-0\"}\n                                        placeholder=\"Write message...\"\n                                        ref={register({ required: true })}\n                                    />\n                                </div>\n                                <div className=\"ml-1\">\n                                    <button type=\"submit\" className=\"btn rounded-circle shadow-none\">\n                                        <div className=\"flex-center flex-column\">\n                                            <Icon icon={ic_near_me} size={24} style={{ color: '#007cfa' }} />\n                                        </div>\n                                    </button>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            }\n        </div>\n    );\n};\n\nexport default MessageRoom;"]},"metadata":{},"sourceType":"module"}