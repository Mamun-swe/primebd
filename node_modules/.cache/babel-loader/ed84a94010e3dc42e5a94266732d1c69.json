{"ast":null,"code":"var _jsxFileName = \"/media/mamun/Tools/MERN/prime-bd/client/src/pages/user/chat/MessageRoom.js\";\nimport React, { useEffect, useState } from 'react';\nimport '../../../styles/user/chat/style.scss';\nimport { useParams } from 'react-router-dom';\nimport Icon from 'react-icons-kit';\nimport { ic_near_me } from 'react-icons-kit/md';\nimport { useForm } from 'react-hook-form';\nimport io from 'socket.io-client';\nimport Navbar from '../../../components/UserNavbar/Index';\nimport LoadingComponent from '../../../components/Loading/Index';\nimport FourOFourComponent from '../../../components/FourOFour/Index'; // import ScrollToBottom from 'react-scroll-to-bottom'\n\nlet socket;\n\nconst MessageRoom = () => {\n  const {\n    id,\n    name\n  } = useParams();\n  const {\n    register,\n    handleSubmit,\n    errors\n  } = useForm();\n  const [isLoading, setLoading] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const myId = localStorage.getItem('id');\n  const ENDPOINT = 'localhost:4000';\n  useEffect(() => {\n    socket = io(ENDPOINT, {\n      transports: ['websocket', 'polling', 'flashsocket']\n    });\n    socket.emit(\"join\", myId);\n    socket.on(\"message\", message => {\n      setMessages(exMessage => [...exMessage, message]);\n    });\n  }, [id, name, myId, ENDPOINT]); // Slice Name\n\n  const sliceName = name => {\n    if (name) return name.slice(0, 1);\n  }; // Submit Message\n\n\n  const onSubmit = async data => {\n    const messageData = {\n      senderId: myId,\n      reciverId: id,\n      message: data.message\n    };\n    setMessages(exMessage => [...exMessage, messageData]);\n    socket.emit('message', messageData, response => {\n      if (response) {\n        console.log('Successfully message send');\n      }\n    });\n  };\n\n  useEffect(() => {\n    const data = {\n      senderId: myId,\n      reciverId: id\n    };\n    socket.emit('getmessage', data, response => {\n      setMessages(response);\n    });\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"message-room\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 9\n    }\n  }, isLoading ? /*#__PURE__*/React.createElement(LoadingComponent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 26\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    title: name,\n    back: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"conversation-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 21\n    }\n  }, messages && messages.length > 0 ? messages.map((items, i) => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"message\",\n    key: i,\n    id: \"message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 37\n    }\n  }, items.sender === myId ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"person-name-circle rounded-circle mr-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 45\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex-center flex-column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 49\n    }\n  }, /*#__PURE__*/React.createElement(\"h6\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 53\n    }\n  }, items.sender))) : null, /*#__PURE__*/React.createElement(\"div\", {\n    className: items.sender == myId ? \"recived-message ml-auto text-right\" : \"sender-message text-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 45\n    }\n  }, items.message)), items.reciver == id ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"person-name-circle rounded-circle ml-1 bg-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 45\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex-center flex-column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 49\n    }\n  }, /*#__PURE__*/React.createElement(\"h6\", {\n    className: \"text-white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 53\n    }\n  }, sliceName(items.reciver)))) : null))) : /*#__PURE__*/React.createElement(FourOFourComponent, {\n    messages: 'No message found.',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 31\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"message-sent-container shadow\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit(onSubmit),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex-fill\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"message\",\n    className: errors.message ? \"form-control shadow-none error-border\" : \"form-control shadow-none border-0\",\n    placeholder: \"Write message...\",\n    ref: register({\n      required: true\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 37\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ml-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn rounded-circle shadow-none\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex-center flex-column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    icon: ic_near_me,\n    size: 24,\n    style: {\n      color: '#007cfa'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 45\n    }\n  })))))))));\n};\n\nexport default MessageRoom;","map":{"version":3,"sources":["/media/mamun/Tools/MERN/prime-bd/client/src/pages/user/chat/MessageRoom.js"],"names":["React","useEffect","useState","useParams","Icon","ic_near_me","useForm","io","Navbar","LoadingComponent","FourOFourComponent","socket","MessageRoom","id","name","register","handleSubmit","errors","isLoading","setLoading","messages","setMessages","myId","localStorage","getItem","ENDPOINT","transports","emit","on","message","exMessage","sliceName","slice","onSubmit","data","messageData","senderId","reciverId","response","console","log","length","map","items","i","sender","reciver","required","color"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport '../../../styles/user/chat/style.scss'\nimport { useParams } from 'react-router-dom'\nimport Icon from 'react-icons-kit'\nimport { ic_near_me } from 'react-icons-kit/md'\nimport { useForm } from 'react-hook-form'\nimport io from 'socket.io-client'\n\nimport Navbar from '../../../components/UserNavbar/Index'\nimport LoadingComponent from '../../../components/Loading/Index'\nimport FourOFourComponent from '../../../components/FourOFour/Index'\n// import ScrollToBottom from 'react-scroll-to-bottom'\n\nlet socket;\n\nconst MessageRoom = () => {\n    const { id, name } = useParams()\n    const { register, handleSubmit, errors } = useForm()\n    const [isLoading, setLoading] = useState(false)\n    const [messages, setMessages] = useState([])\n    const myId = localStorage.getItem('id')\n    const ENDPOINT = 'localhost:4000'\n\n    useEffect(() => {\n        socket = io(ENDPOINT, { transports: ['websocket', 'polling', 'flashsocket'] })\n        socket.emit(\"join\", myId)\n        socket.on(\"message\", (message) => {\n            setMessages((exMessage) => [...exMessage, message])\n        })\n    }, [id, name, myId, ENDPOINT])\n\n\n    // Slice Name\n    const sliceName = name => {\n        if (name)\n            return name.slice(0, 1)\n    }\n\n    // Submit Message\n    const onSubmit = async (data) => {\n        const messageData = {\n            senderId: myId,\n            reciverId: id,\n            message: data.message\n        }\n        setMessages((exMessage) => [...exMessage, messageData])\n\n        socket.emit('message', messageData, (response) => {\n            if (response) {\n                console.log('Successfully message send');\n            }\n        })\n\n    }\n\n\n    useEffect(() => {\n        const data = {\n            senderId: myId,\n            reciverId: id\n        }\n        socket.emit('getmessage', data, (response) => {\n            setMessages(response)\n        })\n    }, []);\n\n\n\n    return (\n        <div className=\"message-room\">\n            {isLoading ? <LoadingComponent /> :\n                <div>\n                    <Navbar title={name} back={true} />\n\n                    {/* Conversation Container */}\n                    <div className=\"conversation-container\">\n\n                        {messages && messages.length > 0 ?\n                            messages.map((items, i) =>\n\n                                <div className=\"message\" key={i} id=\"message\">\n                                    <div className=\"d-flex\">\n                                        {/* Sender */}\n                                        {items.sender === myId ?\n                                            <div className=\"person-name-circle rounded-circle mr-1\">\n                                                <div className=\"flex-center flex-column\">\n                                                    {/* <h6>{sliceName(items.message)}</h6> */}\n                                                    <h6>{items.sender}</h6>\n                                                </div>\n                                            </div>\n                                            : null}\n\n                                        {/* Conversation */}\n                                        <div className={items.sender == myId ? \"recived-message ml-auto text-right\" : \"sender-message text-left\"}>\n                                            <p>{items.message}</p>\n                                        </div>\n\n                                        {/* Reciver */}\n                                        {items.reciver == id ?\n                                            <div className=\"person-name-circle rounded-circle ml-1 bg-primary\">\n                                                <div className=\"flex-center flex-column\">\n                                                    {/* <h6 className=\"text-white\">{sliceName(items.message)}</h6> */}\n                                                    <h6 className=\"text-white\">{sliceName(items.reciver)}</h6>\n                                                </div>\n                                            </div>\n                                            : null}\n                                    </div>\n                                </div>\n\n                            )\n                            : <FourOFourComponent messages={'No message found.'} />}\n\n                    </div>\n\n\n                    {/* Message Sent Container */}\n                    <div className=\"message-sent-container shadow\">\n                        <form onSubmit={handleSubmit(onSubmit)}>\n                            <div className=\"d-flex\">\n                                <div className=\"flex-fill\">\n                                    <input\n                                        type=\"text\"\n                                        name=\"message\"\n                                        className={errors.message ? \"form-control shadow-none error-border\" : \"form-control shadow-none border-0\"}\n                                        placeholder=\"Write message...\"\n                                        ref={register({ required: true })}\n                                    />\n                                </div>\n                                <div className=\"ml-1\">\n                                    <button type=\"submit\" className=\"btn rounded-circle shadow-none\">\n                                        <div className=\"flex-center flex-column\">\n                                            <Icon icon={ic_near_me} size={24} style={{ color: '#007cfa' }} />\n                                        </div>\n                                    </button>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            }\n        </div>\n    );\n};\n\nexport default MessageRoom;"]},"metadata":{},"sourceType":"module"}